<!doctype html>
<html lang="en" class=h-100>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
  <meta content="index, follow" name=robots>
  <link rel="icon" href="/assets/logo_crop.png">
  <link rel="alternate" type="application/rss+xml" href="/post/index.xml" title="RSS Feed for JuliaGPU">

  <link rel="stylesheet" href="/css/bootstrap.min.css">
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
  

  <style>
 .hljs {
     padding: 0;
     background: 0 0
 }
.container {
   max-width: 700px
}

#nav-border {
   border-bottom: 1px solid #212529
}

#main {
   margin-top: 1em;
   margin-bottom: 4em
}

#home-jumbotron {
   background-color: inherit
}

#footer .container {
   padding: 1em 0
}

#footer a {
   color: inherit;
   text-decoration: underline
}

.font-125 {
   font-size: 125%
}

.tag-btn {
   margin-bottom: .3em
}

pre {
   background-color: #f5f5f5;
   border: 1px solid #ccc;
   border-radius: 4px;
   padding: 16px
}

pre code {
   padding: 0;
   font-size: inherit;
   color: inherit;
   background-color: transparent;
   border-radius: 0
}

code {
   padding: 2px 4px;
   font-size: 90%;
   color: #c7254e;
   background-color: #f9f2f4;
   border-radius: 4px
}

img,
iframe,
embed,
video,
audio {
   max-width: 100%
}

.card-img,
.card-img-top,
.card-img-bottom {
   width: initial
}

#main h1>a, #main h2>a, #main h3>a {
   color: inherit;
   text-decoration: none;
}

li p {
   margin: 0
}

.result-title a { text-decoration: none; }
.result-title a:hover { text-decoration: underline; }
.result-preview { color: #808080; }
.resultCount { color: #808080; }
.result-query { font-weight: bold; }
#lunrSearchForm { margin-top: 1em; }

</style>


  
  
    <title>Generating 3D array with SLM ⋅ Numeric Gangster</title>
  
</head>
<body class="d-flex flex-column h-100">
  <div id=nav-border class=container>
    <nav class="navbar navbar-expand-lg navbar-light justify-content-center">
        <ul class="navbar-nav">
            <li class="nav-item "><a class="nav-link" href="/"><i data-feather="home"></i>Home</a></li>
            <li class="nav-item "><a class="nav-link" href="/ReadingList/"><i data-feather="file-text"></i>Reading</a></li>
            <li class="nav-item "><a class="nav-link" href="/Learning/"><i data-feather="book-open"></i>Learning</a></li>
            <li class="nav-item active"><a class="nav-link" href="/TrainingCamps/"><i data-feather="file-text"></i>Training Camps</a></li>
            <li class="nav-item "><a class="nav-link" href="/NextEvent/"><i data-feather="bell"></i>Next Events</a></li>
        </ul>
    </nav>
</div>


  <div class="container">
    <main id=main>

    
<!-- Content appended here -->
 <!doctype html>
<!-- first few lines ... -->
  <script src="/libs/lunr/lunr.min.js"></script>
  <script src="/libs/lunr/lunr_index.js"></script>
  <script src="/libs/lunr/lunrclient.min.js"></script>
</head>
<!-- ... -->
<form id="lunrSearchForm" name="lunrSearchForm">
  <input class="search-input" name="q" placeholder="Enter search term" type="text">
  <input type="submit" value="Search" formaction="/search/index.html">
</form>
<h1 id="generating_3d_array_with_slm"><a href="#generating_3d_array_with_slm" class="header-anchor">Generating 3D array with SLM</a></h1>
<ul>
<li><p>Han Wang: <a href="mailto:hwang924@connect.hkust-gz.edu.cn">hwang924@connect.hkust-gz.edu.cn</a></p>
</li>
</ul>
<h2 id="report"><a href="#report" class="header-anchor">Report</a></h2>
<ol>
<li><p>An example of 3D arrays using programmable holographic optical tweezer.<sup id="fnref:Barredo2018"><a href="#fndef:Barredo2018" class="fnref">[1]</a></sup></p>
<ul>
<li><p>Main method: They imprint a phase pattern &#40;calculated using 3D Gerchberg-Saxton algorithm&#41; on a dipole trap beam at 850 nm with SLM.</p>
</li>
<li><p>The experimental setup is shown below: </p>
</li>
</ul>
<p><img src="figs/image-1.png" alt="Experimental setup" /></p>
<ul>
<li><p>Main parts for a experimental system: 1.  Arbitrary 3D array generation with SLM. 2. Trap imaging system（The second AL together with ad-CCD camera and ETL1 can help measure the intensity distribution in the focal plane）3. Atom imaging system（The fluorescence of the atoms in the traps is at 780nm which is deflected by DM and imaged by EMCCD. 4. Atom sorting system: An extra laser going through AODs can realize moving tweezers through PBS.  </p>
</li>
<li><p>plane by plane assembly: The minimal separation between layers to avoid influence is 14\(\mu\)m.</p>
</li>
<li><p>The sequence for creating fully loaded patterns: The main sequence is shown below. In ech plane, it is required that the number of generated traps should be twice as number of traps that we need to load.  1. Loading the MOT and taking fluorscence pictures of each plane. 2. When enough atoms are loaded on each plane, the assembler starts to work. <img src="figs/image-2.png" alt="alt text" /></p>
</li>
</ul>
</li>
<li><p>Objectives</p>
<ul>
<li><p>create a double layer optical array with SLM.</p>
</li>
</ul>
</li>
<li><p>Methodology</p>
<ul>
<li><p>We mainly use SLM to generate the required holograms.</p>
</li>
<li><p>The holograms are calculated using the 3D Gerchberg-Saxton algorithm.</p>
</li>
</ul>
</li>
<li><p>Gerchberg-Saxton algorithm<sup id="fnref:Keesling"><a href="#fndef:Keesling" class="fnref">[2]</a></sup></p>
<ul>
<li><p>To determine phase-only computer generated holograms&#40;CGHs&#41;, iterative Fourier-transform algorithms &#40;IFTAs&#41;, originally devised by Gerchberg and Saxton, are widely used. GS algorithm is a interative phase finding algorithm that can be used to find complex phases when one only have access to the amplitudes of an image and the amplitude of its Fourier transform.</p>
</li>
<li><p>how to generate an optical focus array with a phase spatial light modulator:</p>
</li>
<li><ul>
<li><p>The large-scale optical focus array are locate at focal plane&#40;n-plane&#41; of a focusing lens and the SLM is placed on the lens&#39; back focal plane&#40;x-plane&#41;. A spatially coherence light beam is reflected by the SLM. The reflected wave front is shaped by a CGH \(\Phi(x)\) displayed on SLM. This phase information can be derived through GS algorithm. </p>
</li>
</ul>
</li>
<li><ul>
<li><p>In GS algorithm, the initial phase information is a random phase map which is uniformly distribute from \(-\pi\) to \(\pi\). Assuming that the amplitude and phase in focal plane is \(B_i(u)\) and \(\Psi(u)\); the amplitude and phase in SLM plane is \(\sqrt(I(x))\) and \(\phi_i(x)\). </p>
</li>
</ul>
</li>
<li><ul>
<li><p>Design a focus pattern that you need. For example, I designed a pattern shown below:<img src="figs/image-6.png" alt="alt text" /></p>
</li>
</ul>
</li>
<li><ul>
<li><p>Performing an inverse Fourier transform to the target intensity distribution, we can get the phase distribution and intensity in the SLM plane.<img src="figs/image-7.png" alt="alt text" />. But the phase information is not clear.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>Now we start to use GS algorithm.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>generating a random initial phase &quot;randphase&quot; \(\phi\).\(A=e^{i*rand(phi)}\).</p>
</li>
</ul>
</li>
<li><ul>
<li><p>\(B=abs(src)\dot e^{iarg(A)}\) to derive the nearfield information at the first cycle.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>Performing FFT on B : \(C=fft(B)\). extract and save the phase information.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>\(D = abs(trg)\dot e^{iarg(C)}\)  keep multiply the target amplitude and input the stored phase information.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>Perform iFFT on D and it is the nearfield information. Compare it with previous A.keep doing this until the phase information is stable.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>After the GS algorithm, the calculated detailed phase map is shown below:<img src="figs/image-8.png" alt="alt text" /></p>
</li>
</ul>
</li>
<li><p>Conclusion: The information of focal plane can be derived by the 2D Fourier transform from SLM plane. In this process, we define a random phase profile for nearfield and we convert it to farfield image through FFT transformation. Then we save the phase information and apply the target intensity to the farfield image and apply an IFFT transformation to it. After many rounds, we can derive a detailed phase profile for the target distribution.</p>
</li>
<li><p>This Gerchberg-Saxon algorithm code &quot;example2D_UPDATE.py&quot; is an interative phase-finding algorithm that can be used to find complex phases when we only have access to the amplitudes of an image and the amplitude of its Fourier transform.</p>
</li>
</ul>
</li>
<li><p>traditional 3D Gerchberg-Saxton algorithm<sup id="fnref:Pengcheng"><a href="#fndef:Pengcheng" class="fnref">[3]</a></sup> </p>
<ul>
<li><p>The intention is to obtain arbitrary three dimensional traps arrangements with a high efficiency.</p>
</li>
<li><p>The traditional 3D GS algorithm:</p>
</li>
<li><ul>
<li><p>Traditinal 3D GS algorithm is used to reproduce multiple planes. Because 3D object can be divided into multiple planes and the iteration loop is constructed between object planes and the kinoform plane.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>In the algorithm, they use the Fresnel transformation to convert the complex-valued function from one plane to another. The Fresnel integral is used to calculate the complex amplitude distribution of a wavefront after it has passed through a given optical system.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>In this way, for the nth plane, the process can be described in :</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>\(U_n=FrT(U_H)=F_n\times exp(i\phi_n)\)  After amplitude replacement, \(U_n^R=T_n\times exp(i\phi_n)\)  where T is the target amplitude for the nth plane. \(U_H=FrT(U_n)=F_H\times exp(i\phi_H)\)  Also, after amplitude transformation: \(U_H^R=T_H\times exp(i\phi_H)\)</p>
<ul>
<li><ul>
<li><p>Blocks for traditinal 3D GS algorithm: In the reproduction, image-qualities in different object planes vary and there is large image-quality difference along the direction of light propagation. Therefore, some planes are clear but some planes are more blurred or even not recognizable. </p>
</li>
</ul>
</li>
<li><ul>
<li><p>The main reason: When enforcing amplitude replacement at one object plane, information of previous planes is lost to some degree. The degree of decay depends on the positions of object planes in the iteration loop.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>For example, as shown in Figure below, the iteration loop: kinoform→ plane 1→ plane 2→...→ plane n →kinoform. </p>
</li>
</ul>
</li>
<li><ul>
<li><p>Plane 1 is the farthest from the final kinoform, so the degree of decay of plane 1 is the highest, and as a result, the image-quality in plane 1 is the worst. </p>
</li>
</ul>
</li>
<li><ul>
<li><p>The image-quality difference among those object planes severely degrades the visual effect of the 3D holographic display.<img src="figs/image-9.png" alt="alt text" /></p>
</li>
</ul>
</li>
</ul>
<ol start="6">
<li><p>3D Gerchberg-Saxton Algorithm<sup id="fnref:Di"><a href="#fndef:Di" class="fnref">[4]</a></sup> <sup id="fnref:Pozzi"><a href="#fndef:Pozzi" class="fnref">[5]</a></sup> <sup id="fnref:Jonathan"><a href="#fndef:Jonathan" class="fnref">[6]</a></sup></p>
<ul>
<li><p>Assuming a uniform illumination on the SLM. Using scalar diffraction theory to propagate the electric field complex amplitude from the jth pixel surface to the location of the mth trap in image space. Summing up the contributions from all the N pixels we obtain the complex amplitude \(v_m\) of electric field on trap m:</p>
</li>
<li><p>The relationship between the complex amplitude of SLM and the complex amplitude on the trap m can be explained as follows:</p>
</li>
<li><p>First, we can talk about Fourier imaging system where the phase change is easy to derive in 1D situation:<img src="figs/image-11.png" alt="alt text" /></p>
</li>
<li><p>For the imaging system mentioned in paper, there is an uniform illumation on SLM. The sum of all contributions from each pixel of SLM will result in a complex amplitude on correspinding trap. </p>
</li>
<li><p>The complex amplitude of SLM:\(u_j=|u|exp(i\Phi_j)\)</p>
</li>
<li><p>Because of the diffraction process:<img src="figs/image-12.png" alt="alt text" /></p>
</li>
<li><p>The whole process can be summerized below:<img src="figs/image-14.png" alt="alt text" /></p>
</li>
<li><p>The complex amplitude on the trap m is:</p>
</li>
<li><p>\(v_m=\frac{d^2exp(i2\pi(2f+z_m)/\lambda)}{i\lambda f}\sum_{j=1,N}|u|exp(i(\phi_j-\Delta_j^m))\) </p>
</li>
<li><p>and</p>
</li>
<li><p>\(\Delta_j^m=\frac{z_m\pi}{\lambda f^2}(x_j^2+y_j^2)+\frac{2\pi}{\lambda f}(x_jx_m+y_jy_m)\)</p>
</li>
<li><p>Summing up the contributions from all the N pixels on SLM, we obtain the complex amplitude on trap m.</p>
</li>
<li><p>The phase map on SLM can be described with:\(\Phi_{cgh}(x_j,y_j)=arg\sum_{N=1}^N\frac{1}{N}exp(-i\Delta^m_j+\theta_n)\)</p>
</li>
<li><p>where \(\theta_n\) is the constant phase terms. If we simply solve the equation shown above, we can derive the phase map on SLM with low quality which is called RS algorithm.</p>
</li>
<li><ol>
<li><p>RS algorithm directly generation:</p>
</li>
</ol>
</li>
<li><ul>
<li><p>The phase map can be directly generated through the Fourier Optics：Assuming that there exists a SLM plane with coordinates&#40;\(x_j,y_j\)&#41; and it generates N 3D spots in the image space with coordinates \((x_m, y_m, z_m)\). Assuming that the phase map in SLM plane is \(\Phi_{cgh}(x_j,y_j)\) and the phase map generating a single spot at coordinates \((x_m, y_m, z_m)\) in the image space is \(\Delta^m_j\).Thus, the whole phase map on SLM can be described with \(\Phi_{cgh}\).</p>
</li>
</ul>
</li>
<li><p>To compute optimal values of \(θ_n\), the GS algorithm proceeds by alternating projections. </p>
</li>
<li><ol start="2">
<li><p>Weighed GS algorithm generation:</p>
</li>
</ol>
</li>
<li><ul>
<li><p>In the weighted Gerchberg-Saxton algorithm, the initial values of the phases \(\theta_n^0\) are chosen at random and it will be determined through a series of alternating projections between the SLM space and the spots’ positions. The algorithm begins by computation of the RS hologram \(\Phi_{cgh}\).</p>
</li>
</ul>
</li>
<li><ul>
<li><p>The inital phase map can be calculated through the equation shown above.</p>
</li>
</ul>
</li>
<li><ul>
<li><p>At the k-th iteration, the field \(E_n^k\) of each spot is calculated as:\(E_n^k=\sum_{x',y'}Aexp(-i(\Phi_{cgh}-\Delta_m^j))\) where \(||A(x_j,y_j)||^2\) is the distribution of light intensity in SLM plane. At this point, \(\theta_n\) and \(a_0\). \(w_n^k=w_n^{k-1}\frac{\langle||E_n^{k-1}||\rangle^N_{n-1}}{||E_n^{k-1}||}\) \(a_n^k=w_n^ka_0\) \(\theta_n=arg(E_n^{k-1})\). where \(w_n^j\) is the weight factors of the n-th spot at the k-th iteration. The weights are updated at each iteration to ensure that the intensity of each spot is equal to the average intensity of all the spots.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>References</p>
</li>
</ol>
<p><table class="fndef" id="fndef:Barredo2018">
    <tr>
        <td class="fndef-backref"><a href="#fnref:Barredo2018">[1]</a></td>
        <td class="fndef-content">Barredo, D., Lienhard, V., de Léséleuc, S. et al. &#91;&quot;Synthetic three-dimensional atomic structures assembled atom by atom.&quot;&#93;&#40;https://doi.org/10.1038/s41586-018-0450-2</td>
    </tr>
</table>
&#41; Nature 561 &#40;2018&#41;: 79–82.</p>
<p><table class="fndef" id="fndef:Keesling">
    <tr>
        <td class="fndef-backref"><a href="#fnref:Keesling">[2]</a></td>
        <td class="fndef-content">Keesling, A., Omran, A. et al., <a href="https://doi.org/10.1364/OL.44.003178">“Large-Scale Uniform Optical Focus Array Generation with a Phase Spatial Light Modulator.”</a>Optics Letters, 44&#40;12&#41;, 3178. </td>
    </tr>
</table>
 <table class="fndef" id="fndef:Di">
    <tr>
        <td class="fndef-backref"><a href="#fnref:Di">[4]</a></td>
        <td class="fndef-content">Di Leonardo, R., Ianni, F. &amp; Ruocco. et al. <a href="https://doi.org/10.1364/OE.15.001913">&quot;Computer generation of optimal holograms for optical trap arrays.&quot;</a> Optics Express, 15&#40;4&#41;, 1913.</td>
    </tr>
</table>
 <table class="fndef" id="fndef:Pengcheng">
    <tr>
        <td class="fndef-backref"><a href="#fnref:Pengcheng">[3]</a></td>
        <td class="fndef-content">Pengcheng, Z., Yan, L. et al. <a href="https://doi.org/10.1002/sdtp.10411">&quot;Multi‐Plane Holographic Display with a Uniform 3D Gerchberg‐Saxton Algorithm.&quot;</a> SID Symposium Digest of Technical Papers, 46, 2015.</td>
    </tr>
</table>
 <table class="fndef" id="fndef:Jonathan">
    <tr>
        <td class="fndef-backref"><a href="#fnref:Jonathan">[6]</a></td>
        <td class="fndef-content">Pozzi, Paolo, and Jonathan Mapelli.<a href="https://doi.org/10.3389/fncel.2021.609505.">&quot;Real Time Generation of Three Dimensional Patterns for Multiphoton Stimulation.&quot;</a> Frontiers in Cellular Neuroscience, 15&#40;609505&#41;, 2021.</td>
    </tr>
</table>
 <table class="fndef" id="fndef:Pozzi">
    <tr>
        <td class="fndef-backref"><a href="#fnref:Pozzi">[5]</a></td>
        <td class="fndef-content">Pozzi, Paolo, Laura Maddalena et al. <a href="https://doi.org/10.3390/mps2010002.">“Fast Calculation of Computer Generated Holograms for 3D Photostimulation through Compressive-Sensing Gerchberg–Saxton Algorithm.”</a> Methods and Protocols 2, no. 1 &#40;December 20, 2018&#41;: 2. </td>
    </tr>
</table>
</p>
<!-- CONTENT ENDS HERE -->
      </main>
    </div> <!-- class="container" -->


    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    

    <footer id=footer class="mt-auto text-center text-muted">
        <div class="container"> Contact: <a href="mailto:jinguoliu@hkust-gz.edu.cn">jinguoliu@hkust-gz.edu.cn</a> </div>
        <div class=container>Made with <a href=https://franklinjl.org>Franklin.jl</a> and <a href=https://julialang.org>the Julia programming language</a>.</div>
    </footer>

    <!-- FEATHER -->
    <script src="/libs/feather/feather.min.js"></script>
    <script>feather.replace()</script>

    <!-- GOOGLE ANALYTICS -->
    <script>
    window.ga = window.ga || function() {
        (ga.q = ga.q || []).push(arguments)
    };
    ga.l = +new Date;
    ga('create', 'UA-154489943-1', 'auto');
    ga('send', 'pageview');
    </script>
    <script async src=https://www.google-analytics.com/analytics.js></script>
    <script src="/libs/lunr/lunr.min.js"></script>

  </body>
</html>
